{"version":3,"sources":["webpack:///./src/pages/c/billing.js","webpack:///./node_modules/querystring-es3/index.js","webpack:///./node_modules/querystring-es3/decode.js","webpack:///./node_modules/querystring-es3/encode.js","webpack:///./src/components/BillingForm/index.js","webpack:///./node_modules/core-js/modules/es6.string.link.js","webpack:///./node_modules/core-js/modules/_string-html.js"],"names":["Billing","componentWillReceiveProps","nextProps","nextContext","auth","isAuthenticated","window","location","href","render","_this$props","_this","props","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","components_Layout__WEBPACK_IMPORTED_MODULE_3__","components_Meta__WEBPACK_IMPORTED_MODULE_4__","site","siteMetadata","title","className","Fragment","_components_BillingForm__WEBPACK_IMPORTED_MODULE_6__","target","React","Component","withAuthentication","exports","decode","parse","__webpack_require__","encode","stringify","hasOwnProperty","obj","prop","Object","prototype","call","module","qs","sep","eq","options","length","regexp","split","maxKeys","len","i","kstr","vstr","k","v","x","replace","idx","indexOf","substr","decodeURIComponent","isArray","push","Array","xs","toString","stringifyPrimitive","isFinite","name","undefined","map","objectKeys","ks","encodeURIComponent","join","f","res","keys","key","moonclerkFormCode","BillingForm","_React$Component","this","setUpFromProps","react__WEBPACK_IMPORTED_MODULE_3___default","state","managementUrl","gatsby_plugin_google_analytics__WEBPACK_IMPORTED_MODULE_7__","id","link","user","accountLevel","apiClient","getMePayment","then","setState","assign","data","management_url","catch","e","console","error","d","t","s","opts","checkoutToken","width","cid","email","src","onload","onreadystatechange","rs","readyState","MoonclerkEmbed","display","scr","getElementsByTagName","parentNode","insertBefore","document","query","queryString","ApiClient","createHTML","url","$export","fails","defined","quot","string","tag","attribute","value","S","String","p1","NAME","exec","O","P","F","test","toLowerCase"],"mappings":"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","file":"component---src-pages-c-billing-js-69c540ceeffeefe6126f.js","sourcesContent":["import React from 'react'\nimport { siteMetadata } from '../../../gatsby-config'\nimport Layout from 'components/Layout'\nimport Meta from 'components/Meta'\nimport { withAuthentication } from '../../context/withAuthentication'\nimport BillingForm from '../../components/BillingForm'\n\nclass Billing extends React.Component {\n  componentWillReceiveProps = (nextProps, nextContext) => {\n    if (nextProps && nextProps.auth && !nextProps.auth.isAuthenticated) {\n      window.location.href = '/'\n    }\n  }\n\n  render = () => {\n    const { location, auth } = this.props\n    return (\n      <Layout location={location} auth={auth}>\n        <Meta site={siteMetadata} title=\"Your Account\" />\n        <div className=\"container mt-3\">\n          <div className=\"account-page\">\n            {auth.isAuthenticated ? (\n              <React.Fragment>\n                <h1>Billing Information</h1>\n\n                <BillingForm auth={auth} />\n\n                <p className=\"small cancel\">\n                  Need to cancel your account or change your email address?\n                  Email{' '}\n                  <a\n                    className=\"text-danger\"\n                    href=\"mailto:info@cfpland.com\"\n                    target=\"_blank\"\n                  >\n                    info@cfpland.com\n                  </a>\n                  .\n                </p>\n              </React.Fragment>\n            ) : (\n              ''\n            )}\n          </div>\n        </div>\n      </Layout>\n    )\n  }\n}\n\nexport default withAuthentication(Billing)\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","import React from 'react'\nimport './style.scss'\nimport queryString from 'querystring'\nimport ApiClient from '../../utilities/api-client'\nimport { OutboundLink } from 'gatsby-plugin-google-analytics'\nconst productionFormCode = '2iupzagf59uu'\nconst localFormCode = '6h2rpgk167vt'\nconst moonclerkFormCode =\n  process.env.NODE_ENV === 'development' ? localFormCode : productionFormCode\n\nclass BillingForm extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      managementUrl: null,\n    }\n\n    this.apiClient = new ApiClient()\n    this.link = 'https://app.moonclerk.com/pay/' + moonclerkFormCode\n    this.setUpFromProps(props)\n  }\n\n  componentWillReceiveProps = (nextProps, nextContext) => {\n    this.setUpFromProps(nextProps)\n  }\n\n  render = () => (\n    <>\n      {this.state.managementUrl ? (\n        <div className=\"mt-3 mb-4\">\n          <p>\n            Payments are securely managed by Moonclerk and Stripe. To change\n            your credit card on file, click the button below.\n          </p>\n          <p className=\"text-center\">\n            <OutboundLink\n              target=\"_blank\"\n              className=\"btn btn-success\"\n              href={this.state.managementUrl}\n            >\n              Update Your Payment Method in Moonclerk\n            </OutboundLink>\n          </p>\n        </div>\n      ) : (\n        <div id={`mc${moonclerkFormCode}`}>\n          <p>\n            <a href={this.link}>CFP Land Professional</a>\n          </p>\n        </div>\n      )}\n    </>\n  )\n\n  setUpFromProps = props => {\n    if (props && props.auth && props.auth.user) {\n      if (props.auth.user.accountLevel === 'pro') {\n        this.apiClient\n          .getMePayment()\n          .then(res => {\n            this.setState({\n              ...this.state,\n              managementUrl: res.data.management_url,\n            })\n          })\n          .catch(e => console.error(e))\n      } else {\n        // Loads up the Moonclerk form\n        let mcForm\n        ;(function(d, t) {\n          var s = d.createElement(t),\n            opts = {\n              checkoutToken: moonclerkFormCode,\n              width: '100%',\n              cid: props.auth.user.id,\n              email: encodeURIComponent(props.auth.user.email),\n            }\n          s.src = 'https://d2l7e0y6ygya2s.cloudfront.net/assets/embed.js'\n          s.onload = s.onreadystatechange = function() {\n            var rs = this.readyState\n            if (rs) if (rs != 'complete') if (rs != 'loaded') return\n            try {\n              mcForm = new MoonclerkEmbed(opts)\n              mcForm.display()\n            } catch (e) {}\n          }\n          var scr = d.getElementsByTagName(t)[0]\n          scr.parentNode.insertBefore(s, scr)\n        })(document, 'script')\n\n        const query = {\n          cid: props.auth.user.id,\n          email: props.auth.user.email,\n        }\n        this.link += '?' + queryString.stringify(query)\n      }\n    }\n  }\n}\n\nexport default BillingForm\n","'use strict';\n// B.2.3.10 String.prototype.link(url)\nrequire('./_string-html')('link', function (createHTML) {\n  return function link(url) {\n    return createHTML(this, 'a', 'href', url);\n  };\n});\n","var $export = require('./_export');\nvar fails = require('./_fails');\nvar defined = require('./_defined');\nvar quot = /\"/g;\n// B.2.3.2.1 CreateHTML(string, tag, attribute, value)\nvar createHTML = function (string, tag, attribute, value) {\n  var S = String(defined(string));\n  var p1 = '<' + tag;\n  if (attribute !== '') p1 += ' ' + attribute + '=\"' + String(value).replace(quot, '&quot;') + '\"';\n  return p1 + '>' + S + '</' + tag + '>';\n};\nmodule.exports = function (NAME, exec) {\n  var O = {};\n  O[NAME] = exec(createHTML);\n  $export($export.P + $export.F * fails(function () {\n    var test = ''[NAME]('\"');\n    return test !== test.toLowerCase() || test.split('\"').length > 3;\n  }), 'String', O);\n};\n"],"sourceRoot":""}